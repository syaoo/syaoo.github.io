---
title: Git使用
tag: git
article_header:
  type: overlay
  theme: dark
  background_color: '#203028'
  background_image:
    gradient: 'linear-gradient(135deg, rgba(34, 139, 87 , .4), rgba(139, 34, 139, .4))'
    src: /assets/images/cover3.jpg
---

一些git基本命令的使用  
<!--more-->

## Git-config
`git config [<options>]`可以查看或者修改git的配置文件信息，作用范围有系统(system)、全局(global)、仓库(local)...等  
下面是仓库的配置文件内容，文件在`./.git/.config`, 使用`git config --local -e `命令可以在文本编辑器打开

```
[core]
	repositoryformatversion = 0
	filemode = true
	bare = false
	logallrefupdates = true
[remote "origin"]
	fetch = +refs/heads/*:refs/remotes/origin/*
	url = https://github.com/test/test.git
[branch "master"]
	remote = origin
	merge = refs/heads/master
```
1. 指定配置文件位置，默认情况下从系统(system)、全局(global)和存储库本地(local)顺序从配置文件读取值 
- `--global`: 使用全局配置文件
- `--system`: 使用系统配置文件
- `--local`: 使用仓库配置文件
2. 操作  
- 查询 

    | 操作         | 说明                             | 参数                 |
    | ------------ | -------------------------------- | -------------------- |
    | --get        | 获取指定字段的值                 | `name [value-regex]` |
    | --get-all    | 获取指定字段的所有值             | `name [value-regex]`  |
    | --get-regexp | 获取正则表达式所匹配字段的所有值 | `name-regex`         |
    | -e, --edit   | 使用默认编辑器打开配置文件       | -                    |
    | -l, --list   | 列出所有配置信息                 | -                    |
    
    示例：
    ```bash
    git config --local -l # 列出当前仓库配置信息

    ## get只返回查询到的第一条信息，get-all返回所有匹配信息
    git config --get-all user.name # 会返回local与system所有user.name值
    git config --get user.name # 只返回local中user.name值
    git config --global --get user.name a* # 返回global中user.name值为a开头的结果
    git config --global --get-regexp user* # 返回global中user开头的字段及其值
    ```
- 修改

    操作|说明|参数
    -|-|-
    --add|添加指定字段的值|`name value`
    --unset|删除指定字段|`name [value-regex]`
    --unset-all|删除所有指定字段|`name [value-regex]`
    --rename-section|重命名指定字段|`old-name new-name`
    --remove-section|移除指定字段|`name`
    
    示例：
    ```bash
    git config --global user.name "Your Name" # 设置全局用户名，如果已存在则修改
    git config --global --add user.name "Your Name" # 添加全局用户名
    git config --local --unset user.name na* # 删除以na开头的用户名
    git config --local --remove-section user # 删除用户信息，section是指`.`前面的字段
    ```
    *上面的`value-regex`参数是要匹配字段值的正则表达式*

## Git的使用
### 创建、克隆仓库  
`git init [<directory>]`会将当前目录（或directory指定的目录）初始化为git仓库；
`git clone <repo> [<dir>]` 克隆指定仓库到当前目录(或dir指定的目录)，如：`git clone https://github.com/test/test.git test1` 将GitHub中的仓库克隆到test1文件夹中。

### Git仓库操作
文件修改后，要将改动提交到repo通常需要使用到`git add`, `git commit`, `git push`三个命令，下面介绍一下这三个命令及其他常用命令。
1. `git add`
    添加```git add```，git add -v -a
2. 提交`git commit -m "message"`

3. `git push`  
 从本地推送分支，使用`git push origin branch-name`，如果推送失败，先用`git pull`抓取远程的新提交；
     在本地创建和远程分支对应的分支，使用`git checkout -b branch-name origin/branch-name`，本地和远程分支的名称最好一致；
 建立本地分支和远程分支的关联，使用`git branch --set-upstream branch-name origin/branch-name`；
4. `git remote`  
     查看远程库信息：`git remote`,`-v`参数显示更详细信息。
 *添加远程库`git remote add origin <url>`*
*删除远程库`git remote delete origin`*  
5. 查看仓库状态：```git status```

6. 查看文件修改内容：```git diff```

7. 查看工作日志：```git log```， 可选参数`--prettry=oneline`使显示简洁， `--graph`可以看到分支合并图。

8. 版本回退，```git reset```，参数：
    ``--mixed``：此为默认方式，不带任何参数的``git reset``，即使这种方式，它回退到某个版本，只保留源码，回退commit和index信息。
    ``--soft``：回退到某个版本，只回退了commit的信息，不会恢复到index file一级。如果还要提交，直接commit即可。
    ``--hard``：彻底回退到某个版本，本地的源码也会变为上一个版本的内容。
    ``HEAD^``：回退上一个版本[^1]。
    ``HEAD^^``：回退上两个版本。
    ``HEAD~n``：回退上n个版本。
    如：``git reset --hard HEAD^``,回退上一个版本；``git reset --hard 1094a``回退到``commit id``前位为``1094a``的版本。

10. 丢弃工作区的修改：``git checkout -- <file>...``.

11. 丢弃暂存区的修改：先回退，在丢弃：``git reset HEAD <file>``, ``git checkout -- <file>...``

12. 从版本库中删除：``git rm``。

13. 远程仓库(GitHub)使用：
     第一步，创建SSH key，``ssh-keygen -t rsa -C "youremail@example.com"``，完成后在用户主目录找到``.ssh``目录里面有``id_rsa``和``id_rsa.pub``两个文件，这两个就是SSH Key的秘钥对，``id_rsa``是私钥，不能泄露出去，`id_rsa.pub`是公钥，可以放心地告诉任何人。
     第二步，登陆GitHub，打开“Account settings”，“SSH Keys”页面，然后，点“Add SSH Key”，填上任意Title，在Key文本框里粘贴`id_rsa.pub`文件的内容
  
    
    
13. 分支管理
      查看分支：`git branch`
      创建分支：`git branch <name>`
      切换分支：`git checkout <name>`
      创建+切换分支：`git checkout -b <name>`
      合并某分支到当前分支：`git merge <name>`，`--no-ff`强制禁用`Fast forward`模式，Git就会在merge时生成一个新的commit，这样，从分支历史上就可以看出分支信息。
      删除分支：`git branch -d <name>`

14. 标签
     命令`git tag <tagname>`用于新建一个标签，默认为`HEAD`，也可以指定一个`commit id`；
     命令`git tag -a <tagname> -m "blablabla..."`可以指定标签信息；
     命令`git tag`可以查看所有标签。
     命令`git push origin <tagname>`可以推送一个本地标签；
     命令`git push origin --tags`可以推送全部未推送过的本地标签；
     命令`git tag -d <tagname>`可以删除一个本地标签；
     命令`git push origin :refs/tags/<tagname>`可以删除一个远程标签

15. [创建Git服务器]
     一、pull操作

1、将远程指定分支 拉取到 本地指定分支上：

```bash
git pull origin <远程分支名>:<本地分支名>
```

2、将远程指定分支 拉取到 本地当前分支上：

```bash
git pull origin <远程分支名>
```

3、将与本地当前分支同名的远程分支 拉取到 本地当前分支上(需先关联远程分支)

```bash
git pull origin
```

在克隆远程项目的时候，本地分支会自动与远程仓库建立追踪关系，可以使用默认的origin来替代远程仓库名，
所以，我常用的命令就是 git pull origin <远程仓库名>，操作简单，安全可控。
二、push操作

1、将本地当前分支 推送到 远程指定分支上（注意：pull是远程在前本地在后，push相反）：

```bash
git push origin <本地分支名>:<远程分支名>
```

2、将本地当前分支 推送到 与本地当前分支同名的远程分支上（注意：pull是远程在前本地在后，push相反）：

```bash
git push origin <本地分支名>
```

3、将本地当前分支 推送到 与本地当前分支同名的远程分支上(需先关联远程分支)

```bash
git push origin
```

同样的，推荐使用第2种方式，`git push origin <远程同名分支名>`
附：

​```bash
// 将本地分支与远程同名分支相关联
git push --set-upstream origin <本地分支名>
```
[注释]大放送

*[注释]: 这里是注释

参考：  
[Git帮助文件档]()  
[Git教程 - 廖雪峰的官方网站](https://www.liaoxuefeng.com/wiki/896043488029600)  
[git操作之pull拉取远程指定分支以及push推送到远程指定分支_开发工具_醉逍遥neo的博客-CSDN博客](https://blog.csdn.net/u010059669/article/details/82670484)  
[git add -A 和 git add . 的区别 - PajamaCat - 博客园](https://www.cnblogs.com/skura23/p/5859243.html)

[^1]:``HEAD``指向当前版本
```

```